#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define HEALTHY 0 // Κατάσταση 0  = Υγιής
#define INFECTED 1 // Κατάσταση 1 = Μολυσμένος
#define N 1000 //Αριθμός Κόμβων

int main(){
    srand(time(NULL));

    FILE *fptr;

    fptr = fopen("infectA.txt","w");

    //Πίνακας των κόμβων
    int nodes[N] = {HEALTHY};

    //Get τον πρώτο infected κόμβο
    int infection = rand() % 1000;

    //Initialize το πρώτο infected κόμβο
    nodes[infection] = INFECTED;

    //Αύξηση του Counter των μολυσμένων
    float infectedCounter = 1;

    //Initialize τα steps 
    int steps = 0;   

    //Μετάδοση της μόλυνσης μέχρι να μολυνθούν όλοι οι κόμβοι
    while(infectedCounter<N){

        //Spread σε random node
        for(int i = 0; i < infectedCounter; ++i){
            infection = rand() % 1000;
            nodes[infection] = INFECTED;
        }

        infectedCounter = 0;

        //Count το συνολικό αριθμό των μολυσμένων
        for(int j = 0; j < N; ++j){
            if(nodes[j] == INFECTED)
            {
                infectedCounter++;
            }
        }
        steps++;
        
        //printf("Step:%d Infected/TotalNodes:%0.3f \n",steps,(infectedCounter/N));
        fprintf(fptr,"Step:%d | Infected/TotalNodes:%0.3f \n",steps,(infectedCounter/N));
    }

    return 0;

}